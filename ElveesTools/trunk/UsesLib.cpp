// UsesLib.cpp: implementation of the CUsesWinsock & CUsesCom classes.
//
//////////////////////////////////////////////////////////////////////

#include "stdafx.h"
#include "UsesLib.h"
#include "Exceptions.h"

//////////////////////////////////////////////////////////////////////
// Namespace: Elvees
//////////////////////////////////////////////////////////////////////

namespace Elvees {

//////////////////////////////////////////////////////////////////////
// CUsesWinsock
//////////////////////////////////////////////////////////////////////

CUsesWinsock::CUsesWinsock()
{
	WORD wVersionRequested = 0x202;

	if(0 != ::WSAStartup(wVersionRequested, &m_data))
	{
		throw CWin32Exception(TEXT("CUsesWinsock::CUsesWinsock()"), ::WSAGetLastError());
	}
}
      
CUsesWinsock::~CUsesWinsock()
{
	WSACleanup();
}

//////////////////////////////////////////////////////////////////////
// CUsesWinsock
//////////////////////////////////////////////////////////////////////

CUsesCom::CUsesCom()
{
	HRESULT hr = CoInitialize(NULL);

	if(FAILED(hr))
	{
		throw CWin32Exception(TEXT("CoInitialize failed"), hr);
	}
}

CUsesCom::~CUsesCom()
{
	CoUninitialize();
}

//////////////////////////////////////////////////////////////////////
// Namespace: Elvees
//////////////////////////////////////////////////////////////////////

} // End of namespace Elvees
